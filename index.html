<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CiteSpace数据采集系统</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- 自动隐藏提示窗口 -->
    <div id="toastNotification" class="toast-notification">
        <span class="toast-icon">✓</span>
        <span class="toast-message">操作成功</span>
    </div>
    <div class="container">
        <div class="header">
            <h1>🔬 CiteSpace数据采集系统</h1>
            <p>教育技术学研究数据采集工具 - 全面版</p>
        </div>
        <div class="settings-bar">
            <div class="settings-controls">
                <div>
                    <label>提供商</label>
                    <select id="provider_select">
                        <option value="doubao">豆包</option>
                        <option value="deepseek">DeepSeek</option>
                    </select>
                </div>
                <div>
                    <label>模型</label>
                    <select id="model_select">
                        <!-- 动态加载模型列表 -->
                    </select>
                </div>
            </div>
            
            <div class="settings-button-group">
                <button class="btn btn-test" id="testApiConnectionBtn">
                    🔗 测试连接
                </button>
                <button class="btn btn-save" id="saveApiSettingsBtn" onclick="saveApiSettings()">
                    💾 保存设置
                </button>
                <button class="btn btn-clear" id="clearAllBtnTop">
                    🗑️ 清空表单
                </button>
            </div>
            
            <div class="settings-status">
                <div id="currentModelStatus" class="status-item" style="color: #28a745; font-weight: 600;">
                    <!-- 当前模型状态将在这里显示 -->
                </div>
            </div>
        </div>
        
        <div class="form-container">
            <!-- 数据检索基础信息 -->
            <div class="section">
                <h3><span class="section-icon">1</span>数据检索基础信息 <span class="section-actions"><button class="btn btn-secondary btn-sm text-capture-btn" data-action="text-capture">📊 图文采集</button></span></h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label>数据库来源 (多个用逗号分隔)</label>
                        <input type="text" id="database_source" data-field-id="database_source" placeholder="如：Web of Science, 中国知网, Scopus, 其他">
                        <small style="color: #666; font-size: 12px;">请输入多个数据库来源，用逗号分隔</small>
                    </div>
                    <div class="form-group">
                        <label>检索策略/关键词</label>
                        <textarea data-field-id="search_strategy" placeholder="例如：以'CiteSpace'为检索词进行全文精确搜索，或选择'传统村落'、'传统聚落'、'古村落'、'历史村落'、'历史文化名村'为检索词，以'篇名'为检索途径"></textarea>
                    </div>
                    <div class="form-group">
                        <label>时间范围</label>
                        <input type="text" data-field-id="time_range" placeholder="如：2010-2024">
                    </div>
                    <div class="form-group">
                        <label>学科范围</label>
                        <input type="text" data-field-id="subject_scope" placeholder="如：教育学、计算机科学、管理学">
                    </div>
                    <div class="form-group">
                        <label>初检文献数</label>
                        <input type="number" data-field-id="initial_papers" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label>最终有效文献数</label>
                        <input type="number" data-field-id="final_papers" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label>文献类型限制</label>
                        <input type="text" data-field-id="document_type_limit" placeholder="如：Article, Review">
                    </div>
                    <div class="form-group">
                        <label>语言限制</label>
                        <input type="text" data-field-id="language_limit" placeholder="如：English">
                    </div>
                    <div class="form-group">
                        <label>CiteSpace版本</label>
                        <input type="text" data-field-id="citespace_version" placeholder="如：6.2.R4">
                    </div>
                    <div class="form-group">
                        <label>时间切片</label>
                        <input type="number" data-field-id="time_slice" placeholder="1">
                    </div>
                    <div class="form-group">
                        <label>节点阈值</label>
                        <input type="text" data-field-id="node_threshold" placeholder="如：2,2,20">
                    </div>
                    <div class="form-group">
                        <label>网络剪枝方法 (多个用逗号分隔)</label>
                        <input type="text" data-field-id="pruning_method" placeholder="如：Pathfinder, MST, Pruning sliced networks">
                    </div>
                </div>
            </div>
            
            <!-- 年发文量趋势分析 -->
            <div class="section">
                <h3><span class="section-icon">2</span>年发文量趋势分析 <span class="section-actions"><button class="btn btn-secondary btn-sm text-capture-btn" data-action="text-capture">📊 图文采集</button></span></h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label>起步期时间段</label>
                        <input type="text" data-field-id="startup_period" placeholder="如：2010-2015">
                    </div>
                    <div class="form-group">
                        <label>起步期年均发文量</label>
                        <input type="number" data-field-id="startup_papers" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label>成长期时间段</label>
                        <input type="text" data-field-id="growth_period" placeholder="如：2016-2020">
                    </div>
                    <div class="form-group">
                        <label>成长期年均发文量</label>
                        <input type="number" data-field-id="growth_papers" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label>爆发期时间段</label>
                        <input type="text" data-field-id="burst_period" placeholder="如：2021-2024">
                    </div>
                    <div class="form-group">
                        <label>爆发期年均发文量</label>
                        <input type="number" data-field-id="burst_papers" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label>成熟期时间段</label>
                        <input type="text" data-field-id="maturity_period" placeholder="如：2023-2024">
                    </div>
                    <div class="form-group">
                        <label>成熟期年均发文量</label>
                        <input type="number" data-field-id="maturity_papers" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label>峰值年份</label>
                        <input type="number" data-field-id="peak_year" placeholder="2024">
                    </div>
                    <div class="form-group">
                        <label>峰值发文量</label>
                        <input type="number" data-field-id="peak_papers" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label>最低谷年份</label>
                        <input type="number" data-field-id="trough_year" placeholder="2010">
                    </div>
                    <div class="form-group">
                        <label>最低谷发文量</label>
                        <input type="number" data-field-id="trough_papers" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label>总体增长率(%)</label>
                        <input type="number" step="0.01" data-field-id="overall_growth_rate" placeholder="0.00">
                    </div>
                    <div class="form-group">
                        <label>近5年增长率(%)</label>
                        <input type="number" step="0.01" data-field-id="recent_5yr_growth_rate" placeholder="0.00">
                    </div>
                </div>
            </div>
            
            <!-- 国家/地区分布 -->
            <div class="section">
                <h3><span class="section-icon">3</span>国家/地区分布 <span class="section-actions"><button class="btn btn-secondary btn-sm text-capture-btn" data-action="text-capture">📊 图文采集</button></span></h3>
                <div class="stats-row">
                    <div class="stats-item">
                        <div class="stats-label">参与国家/地区总数</div>
                        <input type="number" class="stats-input" data-field-id="total_countries" placeholder="0">
                    </div>
                    <div class="stats-item">
                        <div class="stats-label">国际合作文献数</div>
                        <input type="number" class="stats-input" data-field-id="international_collaboration_papers" placeholder="0">
                    </div>
                    <div class="stats-item">
                        <div class="stats-label">国际合作占比(%)</div>
                        <input type="number" step="0.01" class="stats-input" data-field-id="international_collaboration_ratio" placeholder="0.00">
                    </div>
                </div>
                <div class="ranking-group">
                    <div class="ranking-title">🌍 国家/地区排名</div>
                    <div class="ranking-item" style="font-weight: bold; background: #f8f9fa;">
                        <div>排名</div>
                        <div>国家名称</div>
                        <div>发文量</div>
                        <div>占比(%)</div>
                        <div>中心性</div>
                    </div>
                    <div class="ranking-item">
                        <div class="rank-number">1</div>
                        <input type="text" data-field-id="country_1_name" placeholder="国家名称">
                        <input type="number" data-field-id="country_1_papers" placeholder="0">
                        <input type="number" step="0.01" data-field-id="country_1_ratio" placeholder="0.00">
                        <input type="number" step="0.001" data-field-id="country_1_centrality" placeholder="0.000">
                    </div>
                    <div class="ranking-item">
                        <div class="rank-number">2</div>
                        <input type="text" data-field-id="country_2_name" placeholder="国家名称">
                        <input type="number" data-field-id="country_2_papers" placeholder="0">
                        <input type="number" step="0.01" data-field-id="country_2_ratio" placeholder="0.00">
                        <input type="number" step="0.001" data-field-id="country_2_centrality" placeholder="0.000">
                    </div>
                    <div class="ranking-item">
                        <div class="rank-number">3</div>
                        <input type="text" data-field-id="country_3_name" placeholder="国家名称">
                        <input type="number" data-field-id="country_3_papers" placeholder="0">
                        <input type="number" step="0.01" data-field-id="country_3_ratio" placeholder="0.00">
                        <input type="number" step="0.001" data-field-id="country_3_centrality" placeholder="0.000">
                    </div>
                    <div class="ranking-item">
                        <div class="rank-number">4</div>
                        <input type="text" data-field-id="country_4_name" placeholder="国家名称">
                        <input type="number" data-field-id="country_4_papers" placeholder="0">
                        <input type="number" step="0.01" data-field-id="country_4_ratio" placeholder="0.00">
                        <input type="number" step="0.001" data-field-id="country_4_centrality" placeholder="0.000">
                    </div>
                    <div class="ranking-item">
                        <div class="rank-number">5</div>
                        <input type="text" data-field-id="country_5_name" placeholder="国家名称">
                        <input type="number" data-field-id="country_5_papers" placeholder="0">
                        <input type="number" step="0.01" data-field-id="country_5_ratio" placeholder="0.00">
                        <input type="number" step="0.001" data-field-id="country_5_centrality" placeholder="0.000">
                    </div>
                </div>
            </div>
            
            <!-- 期刊分布 -->
            <div class="section">
                <h3><span class="section-icon">4</span>期刊分布 <span class="section-actions"><button class="btn btn-secondary btn-sm text-capture-btn" data-action="text-capture">📊 图文采集</button></span></h3>
                <div class="stats-row">
                    <div class="stats-item">
                        <div class="stats-label">期刊总数</div>
                        <input type="number" class="stats-input" data-field-id="total_journals" placeholder="0">
                    </div>
                    <div class="stats-item">
                        <div class="stats-label">核心期刊数量</div>
                        <input type="number" class="stats-input" data-field-id="core_journals_count" placeholder="0">
                    </div>
                    <div class="stats-item">
                        <div class="stats-label">Q1期刊发文量</div>
                        <input type="number" class="stats-input" data-field-id="q1_journals_papers" placeholder="0">
                    </div>
                    <div class="stats-item">
                        <div class="stats-label">高影响因子期刊数量(IF>5)</div>
                        <input type="number" class="stats-input" data-field-id="high_if_journals_count" placeholder="0">
                    </div>
                </div>
                <div class="ranking-group">
                    <div class="ranking-title">📚 期刊排名</div>
                    <div class="ranking-item" style="font-weight: bold; background: #f8f9fa;">
                        <div>排名</div>
                        <div>期刊名称</div>
                        <div>发文量</div>
                        <div>占比(%)</div>
                        <div>影响因子</div>
                    </div>
                    <div class="ranking-item">
                        <div class="rank-number">1</div>
                        <input type="text" data-field-id="journal_1_name" placeholder="期刊名称">
                        <input type="number" data-field-id="journal_1_papers" placeholder="0">
                        <input type="number" step="0.01" data-field-id="journal_1_ratio" placeholder="0.00">
                        <input type="number" step="0.001" data-field-id="journal_1_impact_factor" placeholder="0.000">
                    </div>
                    <div class="ranking-item">
                        <div class="rank-number">2</div>
                        <input type="text" data-field-id="journal_2_name" placeholder="期刊名称">
                        <input type="number" data-field-id="journal_2_papers" placeholder="0">
                        <input type="number" step="0.01" data-field-id="journal_2_ratio" placeholder="0.00">
                        <input type="number" step="0.001" data-field-id="journal_2_impact_factor" placeholder="0.000">
                    </div>
                    <div class="ranking-item">
                        <div class="rank-number">3</div>
                        <input type="text" data-field-id="journal_3_name" placeholder="期刊名称">
                        <input type="number" data-field-id="journal_3_papers" placeholder="0">
                        <input type="number" step="0.01" data-field-id="journal_3_ratio" placeholder="0.00">
                        <input type="number" step="0.001" data-field-id="journal_3_impact_factor" placeholder="0.000">
                    </div>
                    <div class="ranking-item">
                        <div class="rank-number">4</div>
                        <input type="text" data-field-id="journal_4_name" placeholder="期刊名称">
                        <input type="number" data-field-id="journal_4_papers" placeholder="0">
                        <input type="number" step="0.01" data-field-id="journal_4_ratio" placeholder="0.00">
                        <input type="number" step="0.001" data-field-id="journal_4_impact_factor" placeholder="0.000">
                    </div>
                    <div class="ranking-item">
                        <div class="rank-number">5</div>
                        <input type="text" data-field-id="journal_5_name" placeholder="期刊名称">
                        <input type="number" data-field-id="journal_5_papers" placeholder="0">
                        <input type="number" step="0.01" data-field-id="journal_5_ratio" placeholder="0.00">
                        <input type="number" step="0.001" data-field-id="journal_5_impact_factor" placeholder="0.000">
                    </div>
                </div>
            </div>
            
            <!-- 机构分布 -->
            <div class="section">
                <h3><span class="section-icon">5</span>机构分布 <span class="section-actions"><button class="btn btn-secondary btn-sm text-capture-btn" data-action="text-capture">📊 图文采集</button></span></h3>
                <div class="stats-row">
                    <div class="stats-item">
                        <div class="stats-label">机构总数</div>
                        <input type="number" class="stats-input" data-field-id="total_institutions" placeholder="0">
                    </div>
                    <div class="stats-item">
                        <div class="stats-label">高产机构数量(≥10篇)</div>
                        <input type="number" class="stats-input" data-field-id="high_productivity_institutions" placeholder="0">
                    </div>
                    <div class="stats-item">
                        <div class="stats-label">机构合作文献数</div>
                        <input type="number" class="stats-input" data-field-id="institution_collaboration_papers" placeholder="0">
                    </div>
                    <div class="stats-item">
                        <div class="stats-label">机构合作占比(%)</div>
                        <input type="number" step="0.01" class="stats-input" data-field-id="institution_collaboration_ratio" placeholder="0.00">
                    </div>
                </div>
                <div class="ranking-group">
                    <div class="ranking-title">🏛️ 机构排名</div>
                    <div class="ranking-item" style="font-weight: bold; background: #f8f9fa;">
                        <div>排名</div>
                        <div>机构名称</div>
                        <div>发文量</div>
                        <div>占比(%)</div>
                        <div>中心性</div>
                    </div>
                    <div class="ranking-item">
                        <div class="rank-number">1</div>
                        <input type="text" data-field-id="institution_1_name" placeholder="机构名称">
                        <input type="number" data-field-id="institution_1_papers" placeholder="0">
                        <input type="number" step="0.01" data-field-id="institution_1_ratio" placeholder="0.00">
                        <input type="number" step="0.001" data-field-id="institution_1_centrality" placeholder="0.000">
                    </div>
                    <div class="ranking-item">
                        <div class="rank-number">2</div>
                        <input type="text" data-field-id="institution_2_name" placeholder="机构名称">
                        <input type="number" data-field-id="institution_2_papers" placeholder="0">
                        <input type="number" step="0.01" data-field-id="institution_2_ratio" placeholder="0.00">
                        <input type="number" step="0.001" data-field-id="institution_2_centrality" placeholder="0.000">
                    </div>
                    <div class="ranking-item">
                        <div class="rank-number">3</div>
                        <input type="text" data-field-id="institution_3_name" placeholder="机构名称">
                        <input type="number" data-field-id="institution_3_papers" placeholder="0">
                        <input type="number" step="0.01" data-field-id="institution_3_ratio" placeholder="0.00">
                        <input type="number" step="0.001" data-field-id="institution_3_centrality" placeholder="0.000">
                    </div>
                    <div class="ranking-item">
                        <div class="rank-number">4</div>
                        <input type="text" data-field-id="institution_4_name" placeholder="机构名称">
                        <input type="number" data-field-id="institution_4_papers" placeholder="0">
                        <input type="number" step="0.01" data-field-id="institution_4_ratio" placeholder="0.00">
                        <input type="number" step="0.001" data-field-id="institution_4_centrality" placeholder="0.000">
                    </div>
                    <div class="ranking-item">
                        <div class="rank-number">5</div>
                        <input type="text" data-field-id="institution_5_name" placeholder="机构名称">
                        <input type="number" data-field-id="institution_5_papers" placeholder="0">
                        <input type="number" step="0.01" data-field-id="institution_5_ratio" placeholder="0.00">
                        <input type="number" step="0.001" data-field-id="institution_5_centrality" placeholder="0.000">
                    </div>
                </div>
            </div>
            
            <!-- 作者分析 -->
            <div class="section">
                <h3><span class="section-icon">6</span>作者分析 <span class="section-actions"><button class="btn btn-secondary btn-sm text-capture-btn" data-action="text-capture">📊 图文采集</button></span></h3>
                <div class="stats-row">
                    <div class="stats-item">
                        <div class="stats-label">作者总数</div>
                        <input type="number" class="stats-input" data-field-id="total_authors" placeholder="0">
                    </div>
                    <div class="stats-item">
                        <div class="stats-label">高产作者数量(≥5篇)</div>
                        <input type="number" class="stats-input" data-field-id="high_productivity_authors" placeholder="0">
                    </div>
                    <div class="stats-item">
                        <div class="stats-label">作者合作文献数</div>
                        <input type="number" class="stats-input" data-field-id="author_collaboration_papers" placeholder="0">
                    </div>
                    <div class="stats-item">
                        <div class="stats-label">作者合作占比(%)</div>
                        <input type="number" step="0.01" class="stats-input" data-field-id="author_collaboration_ratio" placeholder="0.00">
                    </div>
                    <div class="stats-item">
                        <div class="stats-label">平均合作度</div>
                        <input type="number" step="0.01" class="stats-input" data-field-id="average_collaboration_degree" placeholder="0.00">
                    </div>
                </div>
                <div class="ranking-group">
                    <div class="ranking-title">👨‍🎓 作者排名</div>
                    <div class="ranking-item" style="font-weight: bold; background: #f8f9fa;">
                        <div>排名</div>
                        <div>作者姓名</div>
                        <div>发文量</div>
                        <div>机构</div>
                        <div>中心性</div>
                    </div>
                    <div class="ranking-item">
                        <div class="rank-number">1</div>
                        <input type="text" data-field-id="author_1_name" placeholder="作者姓名">
                        <input type="number" data-field-id="author_1_papers" placeholder="0">
                        <input type="text" data-field-id="author_1_institution" placeholder="所属机构">
                        <input type="number" step="0.001" data-field-id="author_1_centrality" placeholder="0.000">
                    </div>
                    <div class="ranking-item">
                        <div class="rank-number">2</div>
                        <input type="text" data-field-id="author_2_name" placeholder="作者姓名">
                        <input type="number" data-field-id="author_2_papers" placeholder="0">
                        <input type="text" data-field-id="author_2_institution" placeholder="所属机构">
                        <input type="number" step="0.001" data-field-id="author_2_centrality" placeholder="0.000">
                    </div>
                    <div class="ranking-item">
                        <div class="rank-number">3</div>
                        <input type="text" data-field-id="author_3_name" placeholder="作者姓名">
                        <input type="number" data-field-id="author_3_papers" placeholder="0">
                        <input type="text" data-field-id="author_3_institution" placeholder="所属机构">
                        <input type="number" step="0.001" data-field-id="author_3_centrality" placeholder="0.000">
                    </div>
                    <div class="ranking-item">
                        <div class="rank-number">4</div>
                        <input type="text" data-field-id="author_4_name" placeholder="作者姓名">
                        <input type="number" data-field-id="author_4_papers" placeholder="0">
                        <input type="text" data-field-id="author_4_institution" placeholder="所属机构">
                        <input type="number" step="0.001" data-field-id="author_4_centrality" placeholder="0.000">
                    </div>
                    <div class="ranking-item">
                        <div class="rank-number">5</div>
                        <input type="text" data-field-id="author_5_name" placeholder="作者姓名">
                        <input type="number" data-field-id="author_5_papers" placeholder="0">
                        <input type="text" data-field-id="author_5_institution" placeholder="所属机构">
                        <input type="number" step="0.001" data-field-id="author_5_centrality" placeholder="0.000">
                    </div>
                </div>
            </div>
            
            <!-- 突现词分析 -->
            <div class="section">
                <h3><span class="section-icon">7</span>突现词分析 <span class="section-actions"><button class="btn btn-secondary btn-sm text-capture-btn" data-action="text-capture">📊 图文采集</button></span></h3>
                <div class="stats-row">
                    <div class="stats-item">
                        <div class="stats-label">突现词总数</div>
                        <input type="number" class="stats-input" data-field-id="total_burst_terms" placeholder="0">
                    </div>
                    <div class="stats-item">
                        <div class="stats-label">当前突现词数量</div>
                        <input type="number" class="stats-input" data-field-id="current_burst_terms" placeholder="0">
                    </div>
                </div>
                <div class="ranking-group">
                    <div class="ranking-title">💥 突现词排名</div>
                    <div class="ranking-item" style="font-weight: bold; background: #f8f9fa;">
                        <div>排名</div>
                        <div>词汇</div>
                        <div>突现强度</div>
                        <div>开始时间</div>
                        <div>持续年数</div>
                    </div>
                    <div class="ranking-item">
                        <div class="rank-number">1</div>
                        <input type="text" data-field-id="burst_1_term" placeholder="突现词">
                        <input type="number" step="0.01" data-field-id="burst_1_strength" placeholder="0.00">
                        <input type="number" data-field-id="burst_1_start_year" placeholder="2020">
                        <input type="number" data-field-id="burst_1_duration" placeholder="3">
                    </div>
                    <div class="ranking-item">
                        <div class="rank-number">2</div>
                        <input type="text" data-field-id="burst_2_term" placeholder="突现词">
                        <input type="number" step="0.01" data-field-id="burst_2_strength" placeholder="0.00">
                        <input type="number" data-field-id="burst_2_start_year" placeholder="2020">
                        <input type="number" data-field-id="burst_2_duration" placeholder="3">
                    </div>
                    <div class="ranking-item">
                        <div class="rank-number">3</div>
                        <input type="text" data-field-id="burst_3_term" placeholder="突现词">
                        <input type="number" step="0.01" data-field-id="burst_3_strength" placeholder="0.00">
                        <input type="number" data-field-id="burst_3_start_year" placeholder="2020">
                        <input type="number" data-field-id="burst_3_duration" placeholder="3">
                    </div>
                    <div class="ranking-item">
                        <div class="rank-number">4</div>
                        <input type="text" data-field-id="burst_4_term" placeholder="突现词">
                        <input type="number" step="0.01" data-field-id="burst_4_strength" placeholder="0.00">
                        <input type="number" data-field-id="burst_4_start_year" placeholder="2020">
                        <input type="number" data-field-id="burst_4_duration" placeholder="3">
                    </div>
                    <div class="ranking-item">
                        <div class="rank-number">5</div>
                        <input type="text" data-field-id="burst_5_term" placeholder="突现词">
                        <input type="number" step="0.01" data-field-id="burst_5_strength" placeholder="0.00">
                        <input type="number" data-field-id="burst_5_start_year" placeholder="2020">
                        <input type="number" data-field-id="burst_5_duration" placeholder="3">
                    </div>
                </div>
            </div>
            
            <!-- 聚类分析 -->
            <div class="section">
                <h3><span class="section-icon">8</span>聚类分析 <span class="section-actions"><button class="btn btn-secondary btn-sm text-capture-btn" data-action="text-capture">📊 图文采集</button></span></h3>
                <div class="stats-row">
                    <div class="stats-item">
                        <div class="stats-label">聚类总数</div>
                        <input type="number" class="stats-input" data-field-id="total_clusters" placeholder="0">
                    </div>
                    <div class="stats-item">
                        <div class="stats-label">有效聚类数量</div>
                        <input type="number" class="stats-input" data-field-id="valid_clusters" placeholder="0">
                    </div>
                    <div class="stats-item">
                        <div class="stats-label">平均Silhouette值</div>
                        <input type="number" step="0.001" class="stats-input" data-field-id="average_silhouette" placeholder="0.000">
                    </div>
                    <div class="stats-item">
                        <div class="stats-label">模块度Q值</div>
                        <input type="number" step="0.001" class="stats-input" data-field-id="modularity_q" placeholder="0.000">
                    </div>
                </div>
                <div class="cluster-grid">
                    <div class="cluster-item">
                        <div class="cluster-label">聚类 #0</div>
                        <input type="text" class="cluster-input" data-field-id="cluster_0_name" placeholder="聚类名称">
                        <input type="number" step="0.001" class="cluster-input" data-field-id="cluster_0_silhouette" placeholder="Silhouette值">
                        <input type="number" class="cluster-input" data-field-id="cluster_0_papers" placeholder="文献数">
                        <textarea class="cluster-input" data-field-id="cluster_0_keywords" placeholder="主要关键词" rows="2"></textarea>
                    </div>
                    <div class="cluster-item">
                        <div class="cluster-label">聚类 #1</div>
                        <input type="text" class="cluster-input" data-field-id="cluster_1_name" placeholder="聚类名称">
                        <input type="number" step="0.001" class="cluster-input" data-field-id="cluster_1_silhouette" placeholder="Silhouette值">
                        <input type="number" class="cluster-input" data-field-id="cluster_1_papers" placeholder="文献数">
                        <textarea class="cluster-input" data-field-id="cluster_1_keywords" placeholder="主要关键词" rows="2"></textarea>
                    </div>
                    <div class="cluster-item">
                        <div class="cluster-label">聚类 #2</div>
                        <input type="text" class="cluster-input" data-field-id="cluster_2_name" placeholder="聚类名称">
                        <input type="number" step="0.001" class="cluster-input" data-field-id="cluster_2_silhouette" placeholder="Silhouette值">
                        <input type="number" class="cluster-input" data-field-id="cluster_2_papers" placeholder="文献数">
                        <textarea class="cluster-input" data-field-id="cluster_2_keywords" placeholder="主要关键词" rows="2"></textarea>
                    </div>
                    <div class="cluster-item">
                        <div class="cluster-label">聚类 #3</div>
                        <input type="text" class="cluster-input" data-field-id="cluster_3_name" placeholder="聚类名称">
                        <input type="number" step="0.001" class="cluster-input" data-field-id="cluster_3_silhouette" placeholder="Silhouette值">
                        <input type="number" class="cluster-input" data-field-id="cluster_3_papers" placeholder="文献数">
                        <textarea class="cluster-input" data-field-id="cluster_3_keywords" placeholder="主要关键词" rows="2"></textarea>
                    </div>
                    <div class="cluster-item">
                        <div class="cluster-label">聚类 #4</div>
                        <input type="text" class="cluster-input" data-field-id="cluster_4_name" placeholder="聚类名称">
                        <input type="number" step="0.001" class="cluster-input" data-field-id="cluster_4_silhouette" placeholder="Silhouette值">
                        <input type="number" class="cluster-input" data-field-id="cluster_4_papers" placeholder="文献数">
                        <textarea class="cluster-input" data-field-id="cluster_4_keywords" placeholder="主要关键词" rows="2"></textarea>
                    </div>
                    <div class="cluster-item">
                        <div class="cluster-label">聚类 #5</div>
                        <input type="text" class="cluster-input" data-field-id="cluster_5_name" placeholder="聚类名称">
                        <input type="number" step="0.001" class="cluster-input" data-field-id="cluster_5_silhouette" placeholder="Silhouette值">
                        <input type="number" class="cluster-input" data-field-id="cluster_5_papers" placeholder="文献数">
                        <textarea class="cluster-input" data-field-id="cluster_5_keywords" placeholder="主要关键词" rows="2"></textarea>
                    </div>
                </div>
            </div>
            
            <!-- 关键词分析 -->
            <div class="section">
                <h3><span class="section-icon">9</span>关键词分析 <span class="section-actions"><button class="btn btn-secondary btn-sm text-capture-btn" data-action="text-capture">📊 图文采集</button></span></h3>
                <div class="stats-row">
                    <div class="stats-item">
                        <div class="stats-label">关键词总数</div>
                        <input type="number" class="stats-input" data-field-id="total_keywords" placeholder="0">
                    </div>
                    <div class="stats-item">
                        <div class="stats-label">高频关键词数量(≥10次)</div>
                        <input type="number" class="stats-input" data-field-id="high_frequency_keywords" placeholder="0">
                    </div>
                </div>
                <div class="ranking-group">
                    <div class="ranking-title">🔑 关键词排名</div>
                    <div class="ranking-item" style="font-weight: bold; background: #f8f9fa;">
                        <div>排名</div>
                        <div>词汇</div>
                        <div>频次</div>
                        <div>中心性</div>
                        <div>首现年份</div>
                    </div>
                    <div class="ranking-item">
                        <div class="rank-number">1</div>
                        <input type="text" data-field-id="keyword_1_term" placeholder="关键词">
                        <input type="number" data-field-id="keyword_1_frequency" placeholder="0">
                        <input type="number" step="0.001" data-field-id="keyword_1_centrality" placeholder="0.000">
                        <input type="number" data-field-id="keyword_1_first_year" placeholder="2010">
                    </div>
                    <div class="ranking-item">
                        <div class="rank-number">2</div>
                        <input type="text" data-field-id="keyword_2_term" placeholder="关键词">
                        <input type="number" data-field-id="keyword_2_frequency" placeholder="0">
                        <input type="number" step="0.001" data-field-id="keyword_2_centrality" placeholder="0.000">
                        <input type="number" data-field-id="keyword_2_first_year" placeholder="2010">
                    </div>
                    <div class="ranking-item">
                        <div class="rank-number">3</div>
                        <input type="text" data-field-id="keyword_3_term" placeholder="关键词">
                        <input type="number" data-field-id="keyword_3_frequency" placeholder="0">
                        <input type="number" step="0.001" data-field-id="keyword_3_centrality" placeholder="0.000">
                        <input type="number" data-field-id="keyword_3_first_year" placeholder="2010">
                    </div>
                    <div class="ranking-item">
                        <div class="rank-number">4</div>
                        <input type="text" data-field-id="keyword_4_term" placeholder="关键词">
                        <input type="number" data-field-id="keyword_4_frequency" placeholder="0">
                        <input type="number" step="0.001" data-field-id="keyword_4_centrality" placeholder="0.000">
                        <input type="number" data-field-id="keyword_4_first_year" placeholder="2010">
                    </div>
                    <div class="ranking-item">
                        <div class="rank-number">5</div>
                        <input type="text" data-field-id="keyword_5_term" placeholder="关键词">
                        <input type="number" data-field-id="keyword_5_frequency" placeholder="0">
                        <input type="number" step="0.001" data-field-id="keyword_5_centrality" placeholder="0.000">
                        <input type="number" data-field-id="keyword_5_first_year" placeholder="2010">
                    </div>
                </div>
            </div>
            
            <!-- 时间演化分析 -->
            <div class="section">
                <h3><span class="section-icon">10</span>时间演化分析 <span class="section-actions"><button class="btn btn-secondary btn-sm text-capture-btn" data-action="text-capture">📊 图文采集</button></span></h3>
                <div class="stats-row">
                    <div class="stats-item">
                        <div class="stats-label">演化阶段总数</div>
                        <input type="number" class="stats-input" data-field-id="total_evolution_stages" placeholder="4">
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-label">🕐 阶段1</div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>时间段</label>
                            <input type="text" data-field-id="stage_1_period" placeholder="如：2010-2015">
                        </div>
                        <div class="form-group">
                            <label>主要热点词</label>
                            <textarea data-field-id="stage_1_hot_words" placeholder="用逗号分隔多个热点词" rows="2"></textarea>
                        </div>
                        <div class="form-group">
                            <label>代表性文献数</label>
                            <input type="number" data-field-id="stage_1_papers" placeholder="0">
                        </div>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-label">🕑 阶段2</div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>时间段</label>
                            <input type="text" data-field-id="stage_2_period" placeholder="如：2016-2018">
                        </div>
                        <div class="form-group">
                            <label>主要热点词</label>
                            <textarea data-field-id="stage_2_hot_words" placeholder="用逗号分隔多个热点词" rows="2"></textarea>
                        </div>
                        <div class="form-group">
                            <label>代表性文献数</label>
                            <input type="number" data-field-id="stage_2_papers" placeholder="0">
                        </div>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-label">🕒 阶段3</div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>时间段</label>
                            <input type="text" data-field-id="stage_3_period" placeholder="如：2019-2021">
                        </div>
                        <div class="form-group">
                            <label>主要热点词</label>
                            <textarea data-field-id="stage_3_hot_words" placeholder="用逗号分隔多个热点词" rows="2"></textarea>
                        </div>
                        <div class="form-group">
                            <label>代表性文献数</label>
                            <input type="number" data-field-id="stage_3_papers" placeholder="0">
                        </div>
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-label">🕓 阶段4</div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>时间段</label>
                            <input type="text" data-field-id="stage_4_period" placeholder="如：2022-2024">
                        </div>
                        <div class="form-group">
                            <label>主要热点词</label>
                            <textarea data-field-id="stage_4_hot_words" placeholder="用逗号分隔多个热点词" rows="2"></textarea>
                        </div>
                        <div class="form-group">
                            <label>代表性文献数</label>
                            <input type="number" data-field-id="stage_4_papers" placeholder="0">
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- 核心引文 -->
            <div class="section">
                <h3><span class="section-icon">11</span>核心引文 <span class="section-actions"><button class="btn btn-secondary btn-sm text-capture-btn" data-action="text-capture">📊 图文采集</button></span></h3>
                <div class="stats-row">
                    <div class="stats-item">
                        <div class="stats-label">高被引文献总数(≥10次)</div>
                        <input type="number" class="stats-input" data-field-id="high_cited_papers_total" placeholder="0">
                    </div>
                </div>
                <div class="ranking-group">
                    <div class="ranking-title">📖 高被引文献</div>
                    <div class="ranking-item" style="font-weight: bold; background: #f8f9fa;">
                        <div>排名</div>
                        <div>作者及年份</div>
                        <div>被引频次</div>
                        <div>期刊名称</div>
                        <div>中心性</div>
                    </div>
                    <div class="ranking-item">
                        <div class="rank-number">1</div>
                        <input type="text" data-field-id="citation_1_author_year" placeholder="作者, 年份">
                        <input type="number" data-field-id="citation_1_frequency" placeholder="0">
                        <input type="text" data-field-id="citation_1_journal" placeholder="期刊名称">
                        <input type="number" step="0.001" data-field-id="citation_1_centrality" placeholder="0.000">
                    </div>
                    <div class="ranking-item">
                        <div class="rank-number">2</div>
                        <input type="text" data-field-id="citation_2_author_year" placeholder="作者, 年份">
                        <input type="number" data-field-id="citation_2_frequency" placeholder="0">
                        <input type="text" data-field-id="citation_2_journal" placeholder="期刊名称">
                        <input type="number" step="0.001" data-field-id="citation_2_centrality" placeholder="0.000">
                    </div>
                    <div class="ranking-item">
                        <div class="rank-number">3</div>
                        <input type="text" data-field-id="citation_3_author_year" placeholder="作者, 年份">
                        <input type="number" data-field-id="citation_3_frequency" placeholder="0">
                        <input type="text" data-field-id="citation_3_journal" placeholder="期刊名称">
                        <input type="number" step="0.001" data-field-id="citation_3_centrality" placeholder="0.000">
                    </div>
                    <div class="ranking-item">
                        <div class="rank-number">4</div>
                        <input type="text" data-field-id="citation_4_author_year" placeholder="作者, 年份">
                        <input type="number" data-field-id="citation_4_frequency" placeholder="0">
                        <input type="text" data-field-id="citation_4_journal" placeholder="期刊名称">
                        <input type="number" step="0.001" data-field-id="citation_4_centrality" placeholder="0.000">
                    </div>
                    <div class="ranking-item">
                        <div class="rank-number">5</div>
                        <input type="text" data-field-id="citation_5_author_year" placeholder="作者, 年份">
                        <input type="number" data-field-id="citation_5_frequency" placeholder="0">
                        <input type="text" data-field-id="citation_5_journal" placeholder="期刊名称">
                        <input type="number" step="0.001" data-field-id="citation_5_centrality" placeholder="0.000">
                    </div>
                </div>
            </div>
            
            <!-- 网络拓扑特征 -->
            <div class="section">
                <h3><span class="section-icon">12</span>网络拓扑特征 <span class="section-actions"><button class="btn btn-secondary btn-sm text-capture-btn" data-action="text-capture">📊 图文采集</button></span></h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label>整体网络密度</label>
                        <input type="number" step="0.0001" data-field-id="overall_network_density" placeholder="0.0000">
                    </div>
                    <div class="form-group">
                        <label>作者合作网络密度</label>
                        <input type="number" step="0.0001" data-field-id="author_collaboration_density" placeholder="0.0000">
                    </div>
                    <div class="form-group">
                        <label>关键词共现网络密度</label>
                        <input type="number" step="0.0001" data-field-id="keyword_cooccurrence_density" placeholder="0.0000">
                    </div>
                    <div class="form-group">
                        <label>机构合作网络密度</label>
                        <input type="number" step="0.0001" data-field-id="institution_collaboration_density" placeholder="0.0000">
                    </div>
                    <div class="form-group">
                        <label>最高中心性节点</label>
                        <input type="text" data-field-id="highest_centrality_node" placeholder="节点名称">
                    </div>
                    <div class="form-group">
                        <label>高中心性节点数量</label>
                        <input type="number" data-field-id="high_centrality_nodes_count" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label>网络连通组件数</label>
                        <input type="number" data-field-id="connected_components_count" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label>最大连通组件规模</label>
                        <input type="number" data-field-id="largest_component_size" placeholder="0">
                    </div>
                </div>
            </div>
            
            <!-- 引用模式分析 -->
            <div class="section">
                <h3><span class="section-icon">13</span>引用模式分析 <span class="section-actions"><button class="btn btn-secondary btn-sm text-capture-btn" data-action="text-capture">📊 图文采集</button></span></h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label>总引用次数</label>
                        <input type="number" data-field-id="total_citations" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label>平均被引频次</label>
                        <input type="number" step="0.01" data-field-id="average_citation_frequency" placeholder="0.00">
                    </div>
                    <div class="form-group">
                        <label>自引文献数</label>
                        <input type="number" data-field-id="self_citation_papers" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label>自引率(%)</label>
                        <input type="number" step="0.01" data-field-id="self_citation_rate" placeholder="0.00">
                    </div>
                    <div class="form-group">
                        <label>h指数</label>
                        <input type="number" data-field-id="h_index" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label>g指数</label>
                        <input type="number" data-field-id="g_index" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label>引用半衰期(年)</label>
                        <input type="number" step="0.1" data-field-id="citation_half_life" placeholder="0.0">
                    </div>
                    <div class="form-group">
                        <label>Price指数</label>
                        <input type="number" step="0.01" data-field-id="price_index" placeholder="0.00">
                    </div>
                </div>
            </div>
            
            <!-- 数据质量与可靠性 -->
            <div class="section">
                <h3><span class="section-icon">14</span>数据质量与可靠性 <span class="section-actions"><button class="btn btn-secondary btn-sm text-capture-btn" data-action="text-capture">📊 图文采集</button></span></h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label>缺失数据比例(%)</label>
                        <input type="number" step="0.01" data-field-id="missing_data_ratio" placeholder="0.00">
                    </div>
                    <div class="form-group">
                        <label>重复数据处理数量</label>
                        <input type="number" data-field-id="duplicate_data_processed" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label>网络模块度Q值</label>
                        <input type="number" step="0.001" data-field-id="network_modularity_q" placeholder="0.000">
                    </div>
                    <div class="form-group">
                        <label>平均聚类系数</label>
                        <input type="number" step="0.001" data-field-id="average_clustering_coefficient" placeholder="0.000">
                    </div>
                    <div class="form-group">
                        <label>Top-N参数设置</label>
                        <input type="text" data-field-id="top_n_parameters" placeholder="如：50, 50, 50">
                    </div>
                    <div class="form-group">
                        <label>阈值筛选标准</label>
                        <input type="text" data-field-id="threshold_screening_criteria" placeholder="如：c, cc, ccv">
                    </div>
                    <div class="form-group">
                        <label>数据预处理方法</label>
                        <textarea data-field-id="data_preprocessing_methods" placeholder="描述数据预处理的具体方法"></textarea>
                    </div>
                </div>
            </div>
            
            <!-- 操作按钮 -->
            <div class="action-buttons">
                <button class="btn btn-primary" id="saveDataBtn">
                    💾 保存数据
                </button>
                <button class="btn btn-secondary" id="exportDataBtn">
                    📤 导出Excel
                </button>
                <button class="btn btn-success" id="importDataBtn">
                    📥 导入数据
                </button>
                <button class="btn btn-clear" id="clearAllBtn">
                    🗑️ 清空表单
                </button>
            </div>
        </div>
    </div>

    <!-- 文本采集弹窗 - 美化大屏版本 -->
    <div id="textCaptureOverlay" class="modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <span>📊 图文智能采集</span>
                <button class="modal-close" onclick="closeTextCapture()">&times;</button>
            </div>
            <div class="modal-body">
                <!-- 原始输入区域 -->
                <div>
                    <label>📝 原始文本/图片：</label>
                    <textarea id="textCaptureTextarea" placeholder="粘贴该部分的原文、表格或说明…
💡 可通过粘贴(Ctrl+V)或拖拽图片到此处上传"></textarea>
                    
                    <!-- 图片预览区域 -->
                    <div id="imagePreviewContainer" style="display: none;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <span style="font-size: 14px; color: #1890ff;">📷 已上传图片</span>
                            <button id="removeAllImagesBtn" class="btn btn-sm" style="background: #ff4d4f; color: white; border: none; padding: 4px 8px; border-radius: 4px; font-size: 12px;">🗑️ 全部移除</button>
                        </div>
                        <div id="imagePreviewsContainer" style="display: flex; flex-wrap: wrap; gap: 10px; max-height: 300px; overflow-y: auto; padding: 5px;">
                            <!-- 图片预览将在这里动态添加 -->
                        </div>
                    </div>
                    
                    <!-- 隐藏的图片上传输入框 -->
                    <input type="file" id="imageUploadInput" accept="image/*" style="display:none;">
                    <div style="font-size: 12px; color: #666; text-align: center; margin-top: 5px;">
        💡 可通过粘贴(Ctrl+V)或拖拽图片到此处上传
    </div>
                    
                    <!-- 采集状态显示区域 -->
                    <div id="captureStatusContainer">
                        <div>
                            <div>
                                <div id="statusIcon">⏳</div>
                                <h4 id="statusTitle">准备采集</h4>
                            </div>
                            <div id="statusMessage">
                                等待开始采集...
                            </div>
                            <div id="statusProgress">
                                <div>
                                    <div id="progressBar"></div>
                                </div>
                                <div id="progressText">0%</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 采集结果显示区域 -->
                <div id="captureResultsContainer" style="display: none;">
                    <div>
                        <label>
                            <span style="font-size: 22px;">🎯</span> 采集结果预览
                        </label>
                        <div id="captureResults">
                            <!-- 采集结果将在这里显示 -->
                        </div>
                    </div>
                </div>
                
                <!-- 应用到表单按钮 -->
                <div style="text-align: center; margin-top: 15px;">
                    <button class="btn btn-primary" id="applyToFormBtn" onclick="applyAllResults()" style="display: none;">
                        📋 应用到表单
                    </button>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn" onclick="closeTextCapture()">取消</button>
                <button class="btn btn-primary" id="confirmTextCaptureBtn" onclick="confirmTextCapture()">开始采集</button>
            </div>
        </div>
    </div>

    <!-- 引入配置文件 -->
    <script src="config.js"></script>
    
    <!-- 引入工具函数模块 -->
    <script src="utils.js"></script>
    
    <!-- 引入数据管理模块 -->
    <script src="data-manager.js"></script>
    
    <!-- 引入API配置管理模块 -->
    <script src="api-config.js"></script>
    
    <!-- 引入表单初始化模块 -->
    <script src="form-init.js"></script>
    
    <!-- 引入文字采集核心模块 -->
    <script src="text-capture.js"></script>
    
    <!-- 引入AI分析核心模块 -->
    <script src="ai-core.js"></script>
    
    <!-- 引入AI分析结果显示模块 -->
    <script src="result-display.js"></script>
    
    <!-- 引入AI数据分析应用模块 -->
    <script src="data-apply.js"></script>
    
    <!-- 引入AI分析工具函数模块 -->
    <script src="ai-utils.js"></script>
    
    <!-- 引入AI分析提示词模块 -->
    <script src="prompts/data-retrieval-prompts.js"></script>
    <script src="prompts/publication-trend-prompts.js"></script>
    <script src="prompts/country-distribution-prompts.js"></script>
    <script src="prompts/journal-distribution-prompts.js"></script>
    <script src="prompts/institution-distribution-prompts.js"></script>
    <script src="prompts/author-analysis-prompts.js"></script>
    <script src="prompts/burst-analysis-prompts.js"></script>
    <script src="prompts/cluster-analysis-prompts.js"></script>
    <script src="prompts/keyword-analysis-prompts.js"></script>
    <script src="prompts/temporal-evolution-prompts.js"></script>
    <script src="prompts/core-citations-prompts.js"></script>
    <script src="prompts/network-topology-prompts.js"></script>
    <script src="prompts/citation-pattern-prompts.js"></script>
    <script src="prompts/data-quality-prompts.js"></script>
    <script src="prompts/index.js"></script>
    
    <!-- 引入主初始化模块 -->
    <script src="main.js"></script>
</body>
</html>